<% layout("layouts/boilerplate") %>

<style>
  /* Filters container */
  #filters {
    font-size: 0.1rem;
    margin-top: 1rem;
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 2rem;
    overflow-x: auto;
    padding: 0.5rem 2rem;
    position: relative;
    scroll-behavior: smooth;
    scrollbar-width: none; /* hide scrollbar Firefox */
  }
  #filters::-webkit-scrollbar {
    display: none; /* hide scrollbar Chrome */
  }

  /* Fade edges */
  #filters::before,
  #filters::after {
    content: "";
    position: sticky;
    top: 0;
    width: 60px;
    height: 100%;
    pointer-events: none;
    z-index: 2;
  }
  #filters::before {
    left: 0;
    background: linear-gradient(to right, white, transparent);
  }
  #filters::after {
    right: 0;
    background: linear-gradient(to left, white, transparent);
  }

  /* Filter item */
  .filter {
    flex: 0 0 auto;
    display: flex;
    flex-direction: column;
    align-items: center;
    font-size: 0.8rem;
    opacity: 0.7;
    transition: opacity 0.2s ease, transform 0.2s ease;
    text-align: center;
  }
  .filter div i {
    font-size: 22px; /* Reduced icon size */
    color: #222;
    margin-bottom: 0.3rem;
  }
  .filter:hover {
    opacity: 1;
    transform: scale(1.05);
    cursor: pointer;
  }

  /* Toggles container */
  .toggles-wrapper {
    display: flex;
    gap: 1rem;
    margin-top: 1rem;
    margin-right: 2rem; /* Added margin on right */
    justify-content: flex-end; /* Align to right */
  }

  /* Toggle styles */
  .toggle-btn {
    border: 1px solid #ccc;
    border-radius: 1.5rem;
    padding: 0.4rem 1rem;
    display: flex;
    align-items: center;
    background: white;
    gap: 0.5rem;
    max-width: fit-content;
  }
  .toggle-btn:hover {
    border-color: #999;
  }

  .tax-info {
    font-size: 0.8rem;
    display: none;
  }
  .color{
    color:#222;
    opacity: 0.7;
  }
</style>

<!-- Filters Row -->
<div id="filters">
  <div class="filter">
    <div><i class="fa-solid fa-fire"></i></div>
    <p>Trending</p>
  </div>
  <div class="filter">
    <div><i class="fa-solid fa-bed"></i></div>
    <p>Rooms</p>
  </div>
  <div class="filter">
    <div><i class="fa-solid fa-mountain-city"></i></div>
    <p>Iconic Cities</p>
  </div>
  <div class="filter">
    <div><i class="fa-solid fa-mountain"></i></div>
    <p>Mountains</p>
  </div>
  <div class="filter">
    <div><i class="fa-brands fa-fort-awesome"></i></div>
    <p>Castles</p>
  </div>
  <div class="filter">
    <div><i class="fa-solid fa-person-swimming"></i></div>
    <p>Amazing Pools</p>
  </div>
  <div class="filter">
    <div><i class="fa-solid fa-campground"></i></div>
    <p>Camping</p>
  </div>
  <div class="filter">
    <div><i class="fa-solid fa-cow"></i></div>
    <p>Farms</p>
  </div>
  <div class="filter">
    <div><i class="fa-solid fa-snowflake"></i></div>
    <p>Arctic</p>
  </div>
  <div class="filter">
    <div><i class="fa-solid fa-igloo"></i></div>
    <p>Domes</p>
  </div>
  <div class="filter">
    <div><i class="fa-solid fa-sailboat"></i></div>
    <p>Boats</p>
  </div>
</div>

<!-- Toggles Row -->
<div class="toggles-wrapper">
  <!-- Tax toggle -->
  <div class="toggle-btn">
    <div class="form-check-reverse form-switch">
      <input class="form-check-input" type="checkbox" role="switch" id="switchCheckDefault">
      <label class="form-check-label" for="switchCheckDefault">Display Total after Taxes</label>
    </div>
  </div>

  <!-- New toggle -->
  <div class="toggle-btn">
    <div class="form-check-reverse form-switch"><i class="fa-solid fa-filter color"></i>
      <label class="form-check-label" for="switchCheckExtra">Filters</label>
    </div>
  </div>
</div>

<!-- Listings -->
<div class="container mb-5 mt-3">
  <div class="row justify-content-center g-4">
    <% for(let listing of alllistings){ %>
      <div class="col-lg-4 col-md-6 col-sm-10">
        <a href="/listings/<%= listing.id %>" class="listing-link" style="text-decoration: none;">
          <div class="card listing-card-3d listing-c shadow-sm border-0">
            <img
              src="<%= listing.image.url %>"
              class="card-img-top"
              alt="listings_image"
              style="height: 14rem; object-fit: cover;"
              loading="lazy"
            />
            <div class="card-body">
              <h5 class="card-title mb-1"><%= listing.title %></h5>
              <% if (listing.price != null) { %>
                <p class="mb-1 text-muted">&#8377; <%= listing.price.toLocaleString("en-IN") %>/night  
                  <i class="tax-info">&nbsp;+18% GST</i>
                </p>
              <% } else { %>
                <p class="mb-1 text-muted">Price not available</p>
              <% } %>
              <p class="card-text small text-secondary"><%= listing.description %></p>
            </div>
          </div>
        </a>
      </div>
    <% } %>
  </div>
</div>

<script>
  let taxSwitch = document.getElementById("switchCheckDefault");
  taxSwitch.addEventListener("change", () => {
    let taxInfo = document.getElementsByClassName("tax-info");
    for (let info of taxInfo) {
      info.style.display = taxSwitch.checked ? "inline" : "none";
    }
  });

  // Example handler for the extra toggle
  let extraSwitch = document.getElementById("switchCheckExtra");
  extraSwitch.addEventListener("change", () => {
    if (extraSwitch.checked) {
      console.log("Extra option enabled");
    } else {
      console.log("Extra option disabled");
    }
  });
</script>
